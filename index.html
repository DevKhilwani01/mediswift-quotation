<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mediswift Quotation Generator</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
    }
    .app {
      max-width: 1400px;
      margin: 0 auto;
      background: #ffffff;
      padding: 16px 20px 24px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.08);
    }
    h1 {
      text-align: center;
      font-size: 22px;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      font-size: 12px;
      color: #666;
      margin-bottom: 16px;
    }
    .section-title {
      margin-top: 15px;
      margin-bottom: 8px;
      font-weight: bold;
      font-size: 14px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 3px;
    }
    label {
      font-size: 12px;
      font-weight: bold;
      display: block;
      margin-bottom: 2px;
    }
    input, textarea, select, button {
      width: 100%;
      padding: 6px;
      font-size: 13px;
      margin-bottom: 6px;
    }
    textarea {
      min-height: 220px;
      white-space: pre-wrap;
    }
    .row-3 {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 8px;
    }
    .row-8 {
      display: grid;
      grid-template-columns: repeat(8, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 8px;
    }
    .small-note {
      font-size: 11px;
      color: #555;
      margin-bottom: 8px;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 10px 0;
    }
    button {
      width: auto;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #ccc;
      background: #f0f0f0;
    }
    button.primary {
      background: #007bff;
      border-color: #007bff;
      color: #fff;
    }
    button.danger {
      background: #dc3545;
      border-color: #dc3545;
      color: #fff;
    }
    button.secondary {
      background: #6c757d;
      border-color: #6c757d;
      color: #fff;
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
    .product-card {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 8px 10px;
      margin-bottom: 8px;
      background: #fafafa;
    }
    .product-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    .product-card-title {
      font-weight: bold;
      font-size: 13px;
    }
    .product-card-lines {
      font-size: 12px;
      white-space: pre-wrap;
      margin-bottom: 4px;
    }
    .product-card-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    @media (max-width: 900px) {
      .row-8 {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }
    @media (max-width: 600px) {
      .row-8 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>Mediswift Quotation Generator</h1>
    <div class="subtitle">
      Select preset from Google Sheet → adjust → <b>Add Product to Quote</b> → repeat for all products.
    </div>

    <!-- PRODUCT FORM (single, reusable) -->
    <div class="section-title">Product Details</div>

    <label for="product_preset">Select Product Preset (from Google Sheet)</label>
    <select id="product_preset" onchange="onPresetChange()">
      <option value="">Loading...</option>
    </select>
    <div class="small-note">
      Product presets are loaded from your Google Sheet (tab: <b>Products</b>).
    </div>

    <div class="row-3">
      <div>
        <label for="prod_name">Product Name</label>
        <input id="prod_name" placeholder="Zopiclone" />
      </div>
      <div>
        <label for="prod_power">Power</label>
        <input id="prod_power" placeholder="7.5 mg" />
      </div>
      <div>
        <label for="prod_form">Dosage Form</label>
        <select id="prod_form">
          <option>Tablets</option>
          <option>Capsules</option>
          <option>Injection</option>
          <option>Tube</option>
          <option>Inhaler</option>
        </select>
      </div>
    </div>

    <!-- Line 1 -->
    <div class="small-note"><b>Line 1</b> (e.g. 10 packs (100 pills) = 10 USD (8 GBP))</div>
    <div class="row-8">
      <div>
        <label for="l1_qty">Qty</label>
        <input id="l1_qty" placeholder="10" />
      </div>
      <div>
        <label for="l1_unit">Unit</label>
        <select id="l1_unit">
          <option>packs</option>
          <option>strip</option>
          <option>box</option>
          <option>sachets</option>
        </select>
      </div>
      <div>
        <label for="l1_pillsqty">Pills Qty</label>
        <input id="l1_pillsqty" placeholder="100" />
      </div>
      <div>
        <label for="l1_pillsunit">Pills Unit</label>
        <select id="l1_pillsunit">
          <option>pills</option>
          <option>sachets</option>
          <option>tube</option>
          <option>injection</option>
          <option>vial</option>
          <option>ampouls</option>
          <option>capsule</option>
        </select>
      </div>
      <div>
        <label for="l1_priceamt">Price Amt</label>
        <input id="l1_priceamt" placeholder="10" />
      </div>
      <div>
        <label for="l1_pricecur">Currency</label>
        <select id="l1_pricecur">
          <option>USD</option>
          <option>EUR</option>
          <option>GBP</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
      <div>
        <label for="l1_altamt">Alt Amt</label>
        <input id="l1_altamt" placeholder="8" />
      </div>
      <div>
        <label for="l1_altcur">Alt Currency</label>
        <select id="l1_altcur">
          <option>GBP</option>
          <option>USD</option>
          <option>EUR</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
    </div>

    <!-- Line 2 -->
    <div class="small-note"><b>Line 2</b> (e.g. 50 packs (500 pills) = 45 USD (34 GBP))</div>
    <div class="row-8">
      <div>
        <label for="l2_qty">Qty</label>
        <input id="l2_qty" placeholder="50" />
      </div>
      <div>
        <label for="l2_unit">Unit</label>
        <select id="l2_unit">
          <option>packs</option>
          <option>strip</option>
          <option>box</option>
          <option>sachets</option>
        </select>
      </div>
      <div>
        <label for="l2_pillsqty">Pills Qty</label>
        <input id="l2_pillsqty" placeholder="500" />
      </div>
      <div>
        <label for="l2_pillsunit">Pills Unit</label>
        <select id="l2_pillsunit">
          <option>pills</option>
          <option>sachets</option>
          <option>tube</option>
          <option>injection</option>
          <option>vial</option>
          <option>ampouls</option>
          <option>capsule</option>
        </select>
      </div>
      <div>
        <label for="l2_priceamt">Price Amt</label>
        <input id="l2_priceamt" placeholder="45" />
      </div>
      <div>
        <label for="l2_pricecur">Currency</label>
        <select id="l2_pricecur">
          <option>USD</option>
          <option>EUR</option>
          <option>GBP</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
      <div>
        <label for="l2_altamt">Alt Amt</label>
        <input id="l2_altamt" placeholder="34" />
      </div>
      <div>
        <label for="l2_altcur">Alt Currency</label>
        <select id="l2_altcur">
          <option>GBP</option>
          <option>USD</option>
          <option>EUR</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
    </div>

    <!-- Line 3 -->
    <div class="small-note"><b>Line 3</b> (e.g. 100 packs (1000 pills) = 75 USD (56 GBP))</div>
    <div class="row-8">
      <div>
        <label for="l3_qty">Qty</label>
        <input id="l3_qty" placeholder="100" />
      </div>
      <div>
        <label for="l3_unit">Unit</label>
        <select id="l3_unit">
          <option>packs</option>
          <option>strip</option>
          <option>box</option>
          <option>sachets</option>
        </select>
      </div>
      <div>
        <label for="l3_pillsqty">Pills Qty</label>
        <input id="l3_pillsqty" placeholder="1000" />
      </div>
      <div>
        <label for="l3_pillsunit">Pills Unit</label>
        <select id="l3_pillsunit">
          <option>pills</option>
          <option>sachets</option>
          <option>tube</option>
          <option>injection</option>
          <option>vial</option>
          <option>ampouls</option>
          <option>capsule</option>
        </select>
      </div>
      <div>
        <label for="l3_priceamt">Price Amt</label>
        <input id="l3_priceamt" placeholder="75" />
      </div>
      <div>
        <label for="l3_pricecur">Currency</label>
        <select id="l3_pricecur">
          <option>USD</option>
          <option>EUR</option>
          <option>GBP</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
      <div>
        <label for="l3_altamt">Alt Amt</label>
        <input id="l3_altamt" placeholder="56" />
      </div>
      <div>
        <label for="l3_altcur">Alt Currency</label>
        <select id="l3_altcur">
          <option>GBP</option>
          <option>USD</option>
          <option>EUR</option>
          <option>AUD</option>
          <option>CAD</option>
          <option>NZD</option>
          <option>SGD</option>
          <option>AED</option>
          <option>SAR</option>
          <option>QAR</option>
          <option>KWD</option>
          <option>BHD</option>
          <option>JPY</option>
          <option>CNY</option>
          <option>HKD</option>
          <option>CHF</option>
          <option>ZAR</option>
        </select>
      </div>
    </div>

    <div class="buttons">
      <button class="primary" type="button" onclick="addProductToQuote()">Add Product to Quote</button>
      <button class="secondary" type="button" onclick="clearProductForm()">Clear Form</button>
    </div>

    <!-- PRODUCTS ADDED TO THIS QUOTATION -->
    <div class="section-title">Products in this Quotation</div>
    <div id="quoteProducts" class="small-note">
      No products added yet. Fill the form above and click “Add Product to Quote”.
    </div>

    <!-- GENERATE QUOTATION -->
    <div class="section-title">Generated Quotation</div>
    <div class="buttons">
      <button class="primary" type="button" onclick="generateQuotation()">Generate Quotation</button>
      <button type="button" onclick="copyOutput()">Copy to Clipboard</button>
    </div>
    <textarea id="output" readonly placeholder="Your quotation will appear here..."></textarea>
  </div>

  <script>
    /* ========= GOOGLE SHEETS INTEGRATION ========= */

    // Your Google Apps Script Web App URL (already set)
    const PRODUCTS_API_URL = "https://script.google.com/macros/s/AKfycbwu0gU8YXxDueXl7HpdyNnwZYXIxz0EmGdxvihBqInlRTY9vulKwEozkAB2vRrsLcjtLg/exec";

    let ONLINE_PRODUCTS = [];
    let QUOTE_PRODUCTS = []; // dynamic array of products in this quote

    async function loadProducts() {
      try {
        const res = await fetch(PRODUCTS_API_URL);
        const json = await res.json();
        ONLINE_PRODUCTS = json.products || [];
        fillPresetDropdown();
      } catch (err) {
        console.error("Error loading products", err);
        alert("Could not load online products. Please check your Apps Script deployment.");
        const sel = document.getElementById("product_preset");
        if (sel) {
          sel.innerHTML = "";
          const opt = document.createElement("option");
          opt.value = "";
          opt.textContent = "-- Failed to load products --";
          sel.appendChild(opt);
        }
      }
    }

    function fillPresetDropdown() {
      const sel = document.getElementById("product_preset");
      if (!sel) return;

      sel.innerHTML = "";

      const defOpt = document.createElement("option");
      defOpt.value = "";
      defOpt.textContent = "-- Select Product Preset --";
      sel.appendChild(defOpt);

      ONLINE_PRODUCTS.forEach(p => {
        const opt = document.createElement("option");
        opt.value = p.product_key;
        opt.textContent = `${p.name || ""} ${p.power || ""} ${p.form || ""}`;
        sel.appendChild(opt);
      });

      const customOpt = document.createElement("option");
      customOpt.value = "CUSTOM";
      customOpt.textContent = "Custom (manual entry)";
      sel.appendChild(customOpt);
    }

    function onPresetChange() {
      const sel = document.getElementById("product_preset");
      const key = sel.value;
      if (!key || key === "CUSTOM") {
        return;
      }

      const prod = ONLINE_PRODUCTS.find(p => p.product_key === key);
      if (!prod) return;

      // Fill basic fields
      document.getElementById("prod_name").value  = prod.name  || "";
      document.getElementById("prod_power").value = prod.power || "";
      const formSelect = document.getElementById("prod_form");
      if (prod.form && formSelect) {
        formSelect.value = prod.form;
      }

      // Helper to set line fields from sheet columns
      function setLine(lineIndex, prefix) {
        const qtyKey       = "qty" + lineIndex;
        const unitKey      = "unit" + lineIndex;
        const pillsQtyKey  = "pillsqty" + lineIndex;
        const pillsUnitKey = "pillsunit" + lineIndex;

        document.getElementById(prefix + "_qty").value       = prod[qtyKey] || "";
        const unitSel = document.getElementById(prefix + "_unit");
        if (prod[unitKey] && unitSel) unitSel.value = prod[unitKey];

        document.getElementById(prefix + "_pillsqty").value  = prod[pillsQtyKey] || "";
        const pillsUnitSel = document.getElementById(prefix + "_pillsunit");
        if (prod[pillsUnitKey] && pillsUnitSel) pillsUnitSel.value = prod[pillsUnitKey];
      }

      setLine(1, "l1");
      setLine(2, "l2");
      setLine(3, "l3");
    }

    /* ========= PRODUCT FORM HANDLING ========= */

    function readLineFromForm(prefix) {
      const qty       = document.getElementById(prefix + "_qty").value.trim();
      const unit      = document.getElementById(prefix + "_unit").value.trim();
      const pillsQty  = document.getElementById(prefix + "_pillsqty").value.trim();
      const pillsUnit = document.getElementById(prefix + "_pillsunit").value.trim();
      const priceAmt  = document.getElementById(prefix + "_priceamt").value.trim();
      const priceCur  = document.getElementById(prefix + "_pricecur").value.trim();
      const altAmt    = document.getElementById(prefix + "_altamt").value.trim();
      const altCur    = document.getElementById(prefix + "_altcur").value.trim();

      // If completely empty (no qty and no price), skip this line
      const isEmpty = !qty && !unit && !pillsQty && !pillsUnit && !priceAmt && !priceCur && !altAmt && !altCur;
      if (isEmpty) return null;

      // Require at least qty, unit, main price & currency
      if (!qty || !unit || !priceAmt || !priceCur) {
        return { error: "Missing fields", qty, unit, priceAmt, priceCur };
      }

      return {
        qty,
        unit,
        pillsQty,
        pillsUnit,
        priceAmt,
        priceCur,
        altAmt,
        altCur
      };
    }

    function addProductToQuote() {
      const name  = document.getElementById("prod_name").value.trim();
      const power = document.getElementById("prod_power").value.trim();
      const form  = document.getElementById("prod_form").value.trim();

      if (!name) {
        alert("Please enter Product Name.");
        return;
      }

      const line1 = readLineFromForm("l1");
      const line2 = readLineFromForm("l2");
      const line3 = readLineFromForm("l3");

      const lines = [];
      for (const line of [line1, line2, line3]) {
        if (!line) continue;
        if (line.error) {
          alert("Each filled line must have Qty, Unit, Price Amount and Currency.");
          return;
        }
        lines.push(line);
      }

      if (lines.length === 0) {
        alert("Please fill at least one line with Qty, Unit, Price and Currency.");
        return;
      }

      const product = {
        id: Date.now() + Math.random(),
        name,
        power,
        form,
        lines
      };

      QUOTE_PRODUCTS.push(product);
      clearProductForm();
      renderQuoteProducts();
    }

    function clearProductForm() {
      document.getElementById("product_preset").value = "";
      document.getElementById("prod_name").value = "";
      document.getElementById("prod_power").value = "";
      document.getElementById("prod_form").value = "Tablets";

      ["l1", "l2", "l3"].forEach(prefix => {
        document.getElementById(prefix + "_qty").value = "";
        document.getElementById(prefix + "_unit").value = "packs";
        document.getElementById(prefix + "_pillsqty").value = "";
        document.getElementById(prefix + "_pillsunit").value = "pills";
        document.getElementById(prefix + "_priceamt").value = "";
        document.getElementById(prefix + "_pricecur").value = "USD";
        document.getElementById(prefix + "_altamt").value = "";
        document.getElementById(prefix + "_altcur").value = "GBP";
      });
    }

    function renderQuoteProducts() {
      const container = document.getElementById("quoteProducts");
      if (!QUOTE_PRODUCTS.length) {
        container.innerHTML = "No products added yet. Fill the form above and click “Add Product to Quote”.";
        return;
      }

      let html = "";
      QUOTE_PRODUCTS.forEach((p, index) => {
        let linesText = "";
        p.lines.forEach(line => {
          let row = `${line.qty} ${line.unit}`;
          if (line.pillsQty || line.pillsUnit) {
            row += " (";
            if (line.pillsQty) row += line.pillsQty;
            if (line.pillsQty && line.pillsUnit) row += " ";
            if (line.pillsUnit) row += line.pillsUnit;
            row += ")";
          }
          row += `= ${line.priceAmt} ${line.priceCur}`;
          if (line.altAmt && line.altCur) {
            row += ` (${line.altAmt} ${line.altCur})`;
          }
          linesText += row + "\n";
        });

        html += `
          <div class="product-card">
            <div class="product-card-header">
              <div class="product-card-title">
                Product- ${escapeHtml(p.name)}${p.power ? " " + escapeHtml(p.power) : ""}${p.form ? " " + escapeHtml(p.form) : ""}
              </div>
              <div style="font-size:11px;color:#777;">#${index + 1}</div>
            </div>
            <div class="product-card-lines">${escapeHtml(linesText)}</div>
            <div class="product-card-buttons">
              <button type="button" onclick="editProduct(${index})">Edit</button>
              <button type="button" class="danger" onclick="removeProduct(${index})">Remove</button>
              <button type="button" onclick="moveProductUp(${index})" ${index === 0 ? "disabled" : ""}>Move Up</button>
              <button type="button" onclick="moveProductDown(${index})" ${index === QUOTE_PRODUCTS.length - 1 ? "disabled" : ""}>Move Down</button>
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    function editProduct(index) {
      const p = QUOTE_PRODUCTS[index];
      if (!p) return;

      // Load into form
      document.getElementById("prod_name").value = p.name;
      document.getElementById("prod_power").value = p.power || "";
      document.getElementById("prod_form").value = p.form || "Tablets";
      document.getElementById("product_preset").value = ""; // reset preset

      const prefixes = ["l1", "l2", "l3"];
      prefixes.forEach((prefix, i) => {
        const line = p.lines[i];
        if (!line) {
          // Clear unused lines
          document.getElementById(prefix + "_qty").value = "";
          document.getElementById(prefix + "_unit").value = "packs";
          document.getElementById(prefix + "_pillsqty").value = "";
          document.getElementById(prefix + "_pillsunit").value = "pills";
          document.getElementById(prefix + "_priceamt").value = "";
          document.getElementById(prefix + "_pricecur").value = "USD";
          document.getElementById(prefix + "_altamt").value = "";
          document.getElementById(prefix + "_altcur").value = "GBP";
        } else {
          document.getElementById(prefix + "_qty").value       = line.qty || "";
          document.getElementById(prefix + "_unit").value      = line.unit || "packs";
          document.getElementById(prefix + "_pillsqty").value  = line.pillsQty || "";
          document.getElementById(prefix + "_pillsunit").value = line.pillsUnit || "pills";
          document.getElementById(prefix + "_priceamt").value  = line.priceAmt || "";
          document.getElementById(prefix + "_pricecur").value  = line.priceCur || "USD";
          document.getElementById(prefix + "_altamt").value    = line.altAmt || "";
          document.getElementById(prefix + "_altcur").value    = line.altCur || "GBP";
        }
      });

      // Remove from list so re-adding will replace
      QUOTE_PRODUCTS.splice(index, 1);
      renderQuoteProducts();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function removeProduct(index) {
      QUOTE_PRODUCTS.splice(index, 1);
      renderQuoteProducts();
    }

    function moveProductUp(index) {
      if (index <= 0) return;
      const tmp = QUOTE_PRODUCTS[index - 1];
      QUOTE_PRODUCTS[index - 1] = QUOTE_PRODUCTS[index];
      QUOTE_PRODUCTS[index] = tmp;
      renderQuoteProducts();
    }

    function moveProductDown(index) {
      if (index >= QUOTE_PRODUCTS.length - 1) return;
      const tmp = QUOTE_PRODUCTS[index + 1];
      QUOTE_PRODUCTS[index + 1] = QUOTE_PRODUCTS[index];
      QUOTE_PRODUCTS[index] = tmp;
      renderQuoteProducts();
    }

    /* ========= QUOTATION GENERATION ========= */

    function buildProductText(p) {
      let block = "";
      block += "Product- " + p.name;
      if (p.power) block += " " + p.power;
      if (p.form)  block += " " + p.form;
      block += "\n";

      p.lines.forEach(line => {
        let row = `${line.qty} ${line.unit}`;
        if (line.pillsQty || line.pillsUnit) {
          row += " (";
          if (line.pillsQty) row += line.pillsQty;
          if (line.pillsQty && line.pillsUnit) row += " ";
          if (line.pillsUnit) row += line.pillsUnit;
          row += ")";
        }
        row += `= ${line.priceAmt} ${line.priceCur}`;
        if (line.altAmt && line.altCur) {
          row += ` (${line.altAmt} ${line.altCur})`;
        }
        block += row + "\n";
      });

      block += "\n";
      return block;
    }

    function generateQuotation() {
      if (!QUOTE_PRODUCTS.length) {
        alert("Please add at least one product to the quotation.");
        return;
      }

      let text = "";
      text += "Hello,\n";
      text += "Greetings from Mediswift Medex\n\n";
      text += "We are leading exporter\n";
      text += "We got your enquiry regarding your requirement\n\n";

      QUOTE_PRODUCTS.forEach(p => {
        text += buildProductText(p);
      });

      text += "-:We will provide you 100% doorstep delivery.\n\n";
      text += "-:Discounts / offers will be applied as the quantity increases.\n\n";
      text += "-:We accept all types of payment modes.\n\n";
      text += "-:Connect with us on Whatsapp through this link - HTTPS://wa.me/919373097321\n\n";
      text += "-:Connect with us on Telegram through this link - https://t.me/Mediswift_medex\n\n";
      text += "-:Connect with us on Signal through this link- https://signal.me/#p/%2B919373097321\n\n";
      text += "Regards,\n";
      text += "Mediswift Medex\n";
      text += "Mobile - ‪+919373097321‬\n";
      text += "Website- www.mediswiftmedex.com\n";
      text += "Email id - mediswiftmedex@gmail.com\n";

      document.getElementById("output").value = text;
    }

    function copyOutput() {
      const out = document.getElementById("output");
      out.select();
      out.setSelectionRange(0, 99999);
      document.execCommand("copy");
      alert("Quotation copied!");
    }

    window.addEventListener("load", () => {
      loadProducts();
      clearProductForm();
    });
  </script>
</body>
</html>
